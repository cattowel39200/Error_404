---
layout: post
title: "AutoCAD 폴리라인 합치기, Z좌표 날아가서 울던 시절은 끝났다"
description: "선과 폴리라인 합치면서 Z좌표까지 완벽 보존 - JJJ 리습의 기적"
category: MY LISP
tags: [AutoCAD, LISP, 폴리라인, 3D좌표, JJJ]
date: 2025-01-20
---

## 😭 폴리라인 합쳤더니 Z좌표가 다 0이 되어버렸어요

3D 작업하시는 분들, 이런 경험 있으시죠?

**상황:** 여러 개의 선(LINE)을 폴리라인(POLYLINE)으로 합치고 싶음

**AutoCAD 기본 명령:**
```
명령: PEDIT
M (Multiple) → 객체 선택 → Y (Yes) → J (Join)
```

**결과:**
```
✅ 폴리라인 합치기 성공!
❌ 그런데... Z좌표가 전부 0으로!!! 😱
```

**특히 토목 설계나 지형 작업에서는 치명적이에요!**

- 종단도: Z좌표 = 높이 정보
- 배관: Z좌표 = 매설 깊이
- 지형: Z좌표 = 표고

Z좌표 날아가면 **작업 처음부터 다시!** 💢

그래서 고민했습니다.

> "폴리라인 합치면서 Z좌표도 보존할 수는 없을까?"

그 답이 바로 **JJJ 리습**입니다! 🎯

---

## ⚡ JJJ 리습의 특별함

일반 PEDIT JOIN과 뭐가 다르냐고요?

**기본 PEDIT:**
- ❌ Z좌표 → 0으로 초기화
- ❌ 3D 정보 손실
- ❌ 다시 작업해야 함

**JJJ 리습:**
- ✅ Z좌표 완벽 보존
- ✅ 3D 정보 유지
- ✅ 한 번에 끝!

**이게 바로 차이입니다!** ✨

---

## 📖 사용 방법 (간단 3단계)

### 1단계: LISP 로드

`APPLOAD` → `AN_JJJ_폴리라인합치기.lsp` 로드

### 2단계: 명령어 실행 및 선택

```
명령: JJJ
선택할 선 또는 폴리라인을 선택하십시오...
[드래그로 선택!]
```

### 3단계: 자동 처리

```
선택된 객체를 하나의 폴리라인으로 결합하는 중...
Object Type: AcDbLine
Object Type: AcDbLine
...
선택된 선 및 폴리라인이 하나의 폴리라인으로 결합되었고 원본 Z좌표를 복원하였습니다.
```

**끝!** Z좌표가 보존된 폴리라인 완성! 🎉

---

## 🎯 실전 활용 예시

### 예시 1: 종단도 작성

**상황:** 도로 종단선을 여러 선으로 그렸는데 하나의 폴리라인으로 합쳐야 함

**Before:**
```
선1: (0, 0, 100.5)
선2: (10, 0, 101.2)
선3: (20, 0, 102.8)
```

**PEDIT JOIN 사용 시:**
```
결과: 모두 Z = 0 💀
→ 높이 정보 전부 손실!
```

**JJJ 사용 시:**
```
결과: Z좌표 완벽 유지!
(0, 0, 100.5) → (10, 0, 101.2) → (20, 0, 102.8)
```

**종단선 완성!** ✅

---

### 예시 2: 배관 라인

**상황:** 배관 경로를 여러 선으로 그렸고, 각 선의 Z좌표는 매설 깊이

```
Before (각 선의 Z좌표):
- 구간1: Z = -2.5m (2.5m 매설)
- 구간2: Z = -3.0m (3.0m 매설)
- 구간3: Z = -2.8m (2.8m 매설)

JJJ로 합치기 → Z좌표 유지!
```

**배관 심도 정보 살아있음!** 👍

---

### 예시 3: 지형 컨투어

**상황:** 등고선을 여러 선분으로 작성했고, Z = 표고값

```
표고 100m 등고선 여러 선으로 구성
→ JJJ로 합치면 Z = 100 유지!

표고 정보 손실 없음!
```

**지형 데이터 완벽 보존!** 🏔️

---

## 💡 리습 내부 동작 원리

### 1단계: Z좌표 저장

```
모든 선분의 시작점, 끝점 Z좌표를 (X,Y) 기준으로 저장
```

### 2단계: 임시로 Z=0 설정

```
PEDIT JOIN을 위해 일단 Z좌표를 0으로 변경
```

### 3단계: PEDIT JOIN 실행

```
기본 AutoCAD 명령으로 폴리라인 결합
```

### 4단계: Z좌표 복원

```
저장해둔 Z좌표 값을 다시 대입
```

**4단계 자동화로 완벽 보존!** 🧠

---

## 🔥 꿀팁 모음

### 팁 1: 허용 거리 자동 설정

```
기본 허용 거리: 0.005 (5mm)
```

선들이 완전히 붙어있지 않아도 **5mm 이내면 자동으로 연결!**

### 팁 2: LINE + LWPOLYLINE + POLYLINE 모두 지원

```
✅ 단순 선 (LINE)
✅ 경량 폴리라인 (LWPOLYLINE)
✅ 2D 폴리라인 (POLYLINE)
```

**섞여 있어도 문제없어요!** 👌

### 팁 3: Undo 그룹으로 안전하게

작업이 잘못되었다면?

```
명령: U
```

**한 번에 원상복구!** Undo 그룹이 적용되어 있어요. 🛡️

### 팁 4: 중간 과정 로그 표시

```
Object Type: AcDbLine
Coordinates: (0.0 0.0 100.5) ...
New Object Type: AcDb2dPolyline
```

처리 과정이 화면에 표시되니까 **뭐가 진행되는지 알 수 있어요!** 📊

---

## ⚠️ 주의사항

### 주의 1: 중복 좌표 처리

```
만약 같은 (X, Y) 위치에 서로 다른 Z 값이 있다면?
→ 마지막 값으로 덮어씌워짐
```

**되도록 중복 없이 작업하세요!**

### 주의 2: LWPOLYLINE의 한계

```
LWPOLYLINE은 기본적으로 Z = 0
→ JJJ가 POLYLINE(2dPolyline)으로 변환해줌
```

**자동 변환되니 걱정 마세요!** 👍

### 주의 3: 엄청 많은 선은 시간 걸림

```
선 100개 이상일 경우 몇 초 소요
→ 커피 한 모금 하고 오세요 ☕
```

---

## 📊 시간 절약 계산

**Z좌표가 있는 선 50개 합치기:**

| 방법 | 소요 시간 | Z좌표 보존 |
|------|-----------|------------|
| PEDIT + Z 수동 입력 | 약 30분 | 실수 가능 |
| JJJ 리습 | **30초** | 완벽 보존 |

**시간 절약: 98%!** 🎉

**3D 작업자라면 필수 리습!** 💯

---

## 🚀 이런 분들께 강추!

- 토목 설계 (종단도, 평면도)
- 배관 설계 (매설 깊이 중요)
- 지형 작업 (표고 데이터)
- 3D 모델링 하시는 분
- Z좌표 손실로 고생하신 분

---

## 🔧 개발 비하인드

**이 리습을 만든 이유:**

```
처음에는 저도 PEDIT JOIN 쓰다가
Z좌표 날아가서 3시간 작업 날려먹음 😭

"이건 자동화해야겠다!" → JJJ 탄생
```

**같은 고통 겪는 분 없기를!** 🙏

---

## 💬 사용자 후기

> "종단도 작업 시간이 절반으로 줄었어요!"
> - 토목 설계 ㅇㅇ님

> "Z좌표 손실 걱정 이제 안 해요"
> - 배관 설계 ㅇㅇ님

> "3D 작업자 필수 리습입니다!"
> - 지형 설계 ㅇㅇ님

---

## 📝 마무리하며

폴리라인 합치기, 이제 Z좌표 걱정 없어요!

**JJJ 리습 하나면 3D 정보를 완벽하게 보존**할 수 있습니다. ✨

AutoCAD 기본 기능으로는 불가능한 걸 가능하게 만든 **마법 같은 리습**이에요!

다음 포스팅에서는 **해치 일괄 삭제 리습**을 소개해드릴게요.

블록 내부까지 숨어있는 해치도 싹 지워버리는 강력한 도구... 기대하세요! 🧹

---

**명령어:** JJJ
**파일명:** AN_JJJ_폴리라인합치기.lsp
**AutoCAD 버전:** 2000 이상 (Visual LISP 필요)
**난이도:** ⭐⭐⭐☆☆ (중급)
**유용도:** ⭐⭐⭐⭐⭐ (3D 작업자 필수!)
**기술 난이도:** ⭐⭐⭐⭐☆ (Z좌표 보존 알고리즘)

> 💬 **Z좌표 관련 고민 있으신가요?**
> 3D 작업 관련 팁이나 질문 댓글로 공유해주세요! 😊
