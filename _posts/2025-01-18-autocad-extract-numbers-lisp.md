---
layout: post
title: "AutoCAD 텍스트에서 숫자만 쏙 빼내는 마법 같은 COOO 리습"
description: "혼합된 텍스트에서 숫자만 추출해서 복사 - 수량 산출이 이렇게 쉬웠다니!"
category: MY LISP
tags: [AutoCAD, LISP, 수량산출, 자동화, COOO]
date: 2025-01-18
---

## 😤 "면적 123.45㎡" 에서 123.45만 복사하고 싶었어요

도면 작업하다 보면 이런 텍스트들 많이 보시죠?

```
면적 123.45㎡
길이 15.5m
수량: 200개
합계 $1,234.56
```

이런 텍스트에서 **숫자만** 빼내야 할 때가 있어요.

엑셀에 수량 입력할 때, 계산기에 값 넣을 때...

근데 이게 은근히 귀찮아요!

**기존 방법:**
```
1. 텍스트 더블클릭
2. 마우스로 드래그해서 숫자 부분만 선택
3. Ctrl+C 복사
4. 엑셀이나 다른 곳에 붙여넣기
```

한두 개면 괜찮은데, **50개, 100개 하려면 정말 미치겠죠?** 😱

그래서 고민했습니다.

> "텍스트 선택만 하면 숫자가 자동으로 추출되면 안 될까?"

그 고민의 결과물이 **COOO 리습**입니다! 🎯

---

## ⚡ COOO 리습이 하는 일

딱 하나만 합니다.

**텍스트에서 숫자만 쏙 빼내서 복사!**

- 단위(㎡, m, 개)는 자동 제거
- 소수점(.)도 보존
- 천단위 쉼표(,)도 유지
- 부호(+, -)도 처리

**똑똑하죠?** 🧠

---

## 📥 다운로드

### LISP 파일 다운로드
**파일명:** AN_COOO_숫자만추출복사.lsp

👉 **[여기를 클릭하여 다운로드](https://raw.githubusercontent.com/cattowel39200/Error_404/main/AN_lisp/AN_COOO_%EC%88%AB%EC%9E%90%EB%A7%8C%EC%B6%94%EC%B6%9C%EB%B3%B5%EC%82%AC.lsp)**

### 설치 방법
1. 위 링크 클릭 → 마우스 우클릭 → "다른 이름으로 저장"
2. 파일을 `.lsp` 확장자로 저장
3. AutoCAD에서 `APPLOAD` 명령어 실행
4. 저장한 `.lsp` 파일 선택하여 로드

---

## 📖 사용 방법 (3단계면 끝)

### 1단계: LISP 로드

`APPLOAD` → `AN_COOO_숫자만추출복사.lsp` 로드

### 2단계: 명령어 실행 및 객체 선택

```
명령: COOO
통계를 작성할 객체들을 선택하세요: [텍스트들 드래그로 선택!]
```

### 3단계: 복사 위치 지정

```
5개의 객체가 선택되었습니다.
5개의 숫자 객체를 생성합니다.
복사 기준점을 지정하세요: [클릭]
복사될 위치를 지정하세요: [클릭]
작업 완료! 숫자 부분만 복사되었습니다.
```

**끝!** ✨

---

## 🎯 실전 활용 예시

### 예시 1: 면적표 숫자만 추출

**도면 텍스트:**
```
A구역: 123.45㎡
B구역: 87.90㎡
C구역: 156.78㎡
```

**COOO 실행 후:**
```
123.45
87.90
156.78
```

**엑셀에 그대로 복사 붙여넣기 완료!** 📊

---

### 예시 2: 수량표에서 숫자만 추출

**기존:**
```
철근 D10: 250개
철근 D13: 180개
철근 D16: 95개
```

**COOO 후:**
```
250
180
95
```

**계산기에 바로 입력 가능!** 🧮

---

### 예시 3: 금액 정보 추출

**텍스트:**
```
합계 $1,234.56
부가세 $123.46
총액 $1,358.02
```

**COOO 실행:**
```
1,234.56
123.46
1,358.02
```

**쉼표(,)도 유지되니까 엑셀에서 바로 인식!** 💰

---

## 💡 똑똑한 기능들

### 기능 1: 소수점 처리

```
입력: "면적 123.45㎡"
출력: "123.45"
```

소수점 **한 개만** 추출해요. 여러 개 있으면 첫 번째만!

### 기능 2: 천단위 쉼표 유지

```
입력: "수량: 1,234,567개"
출력: "1,234,567"
```

쉼표도 똑똑하게 처리! 엑셀이 바로 인식하는 형식! 👍

### 기능 3: 부호 처리

```
입력: "온도 -15.5°C"
출력: "-15.5"

입력: "증가량 +12.3%"
출력: "+12.3"
```

플러스(+), 마이너스(-) 부호도 함께 추출!

### 기능 4: 복잡한 텍스트도 OK

```
입력: "ABC-123.45-XYZ-678.90-END"
출력: "123.45"
```

**첫 번째로 나온 숫자만** 추출합니다!

---

## 🔥 엑셀 연동 꿀팁

### 방법: COOO + 엑셀로 수량 산출 자동화

```
1. AutoCAD에서 COOO로 숫자 추출
2. 복사된 숫자들 전체 선택 (Ctrl+A)
3. Ctrl+C로 복사
4. 엑셀에 붙여넣기
5. 엑셀에서 SUM 함수로 합계 계산
```

**전체 과정 1분 안에 완료!** ⚡

**기존 방법:**
- 하나씩 수동 입력: 10분+

**COOO 사용:**
- 자동 추출 + 복사: 1분

**시간 절약: 90%!** 🎉

---

## 🤔 주의사항

### 주의 1: 숫자 없는 텍스트는 무시

```
텍스트: "No Data Available"
결과: 선택되지 않음
```

숫자가 없으면 자동으로 건너뛰어요. 안전함! 🛡️

### 주의 2: MTEXT도 지원

단일행 텍스트(TEXT)는 물론, **여러행 텍스트(MTEXT)**도 처리합니다!

### 주의 3: 복사된 객체는 임시

```
복사 → 위치 지정 → 자동 삭제
```

숫자 객체는 **복사 직후 자동으로 삭제**됩니다.

원본 텍스트는 그대로 유지! 👍

---

## 📊 시간 절약 계산

**텍스트 50개에서 숫자 추출:**

| 방법 | 소요 시간 | 정확도 |
|------|-----------|--------|
| 수동 (하나씩 복사) | 약 15분 | 실수 가능 |
| COOO 리습 | **30초** | 100% 정확 |

**하루에 3번만 해도:**
- 기존: 45분
- COOO: 1분 30초

**하루 43분 30초 절약!** 💰

한 달이면? 일 년이면? **엄청난 시간**이에요!

---

## 🚀 이런 분들께 강추!

- 수량 산출 업무 자주 하시는 분
- 도면 데이터를 엑셀로 옮기시는 분
- 면적/길이 정보 정리하시는 분
- 반복 작업에 지치신 분
- 정확한 데이터 필요하신 분

---

## 🔧 개발자 노트

이 리습의 핵심 함수는 `ExtractNumericOnly`예요.

```lisp
;; 텍스트에서 숫자만 추출하는 함수
(defun ExtractNumericOnly (str)
  ;; 숫자(0-9), 소수점(.), 쉼표(,), 부호(+/-) 인식
  ;; 첫 번째 숫자 블록만 추출
)
```

**ASCII 코드로 문자 하나씩 검사**해서 숫자만 쏙쏙 빼내요! 🔍

---

## 💬 실제 사용 후기

> "수량 산출 시간이 80% 줄었어요!"
> - 토목 설계 ㅇㅇ님

> "손으로 하나씩 치던 게 바보 같았어요..."
> - 건축 적산 ㅇㅇ님

> "이거 없이 어떻게 일했는지 모르겠어요 ㅋㅋ"
> - 기계 설계 ㅇㅇ님

---

## 📝 마무리하며

텍스트에서 숫자만 추출하기, 이제 클릭 몇 번이면 끝!

**COOO 리습 하나면 수량 산출이 완전 쉬워집니다.** ✨

복잡한 텍스트도, 많은 양도 걱정 없어요!

다음 포스팅에서는 **텍스트 내용 연속 복사 리습**을 소개해드릴게요.

하나의 텍스트를 10개, 20개에 연속으로 적용... 완전 꿀팁! 🍯

---

**명령어:** COOO (또는 COPYNUM)
**파일명:** AN_COOO_숫자만추출복사.lsp
**AutoCAD 버전:** 2000 이상
**난이도:** ⭐⭐☆☆☆ (쉬움!)
**유용도:** ⭐⭐⭐⭐⭐ (초강력 추천!)

> 💬 **여러분의 활용 사례를 들려주세요!**
> COOO 리습으로 어떤 작업을 하셨나요? 댓글로 공유해주세요! 😊
