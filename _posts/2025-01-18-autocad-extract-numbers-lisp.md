---
layout: post
title: "AutoCAD 숫자 추출 복사 리습 - COOO"
description: "텍스트에서 숫자만 추출하여 복사하는 AutoCAD LISP 유틸리티"
category: MY LISP
tags: [AutoCAD, LISP, 수량산출, COOO]
date: 2025-01-18
---

## 목적

AutoCAD 도면에서 수량 산출이나 데이터 정리 시, 텍스트에 포함된 숫자만 추출해야 하는 경우가 빈번합니다. COOO 리습은 혼합된 텍스트에서 숫자만 자동으로 추출하여 복사함으로써 수작업을 대폭 줄입니다.

## 목차

- [개요](#개요)
- [다운로드](#다운로드)
- [사용 방법](#사용-방법)
- [활용 예시](#활용-예시)
- [주의사항](#주의사항)
- [관련 리습](#관련-리습)

## 개요

COOO(Copy Only Number) 리습의 주요 기능은 다음과 같습니다.

**주요 기능**
- 텍스트에서 숫자만 자동 추출
- 소수점 보존
- 천단위 쉼표 유지
- 부호(+, -) 처리
- TEXT 및 MTEXT 지원
- 단위 문자 자동 제거

**기술적 특징**
- ASCII 코드 기반 문자 분석
- 첫 번째 숫자 블록만 추출
- 빠른 처리 속도

## 다운로드

**파일명:** AN_COOO_숫자만추출복사.lsp

[다운로드 링크](https://raw.githubusercontent.com/cattowel39200/Error_404/main/AN_lisp/AN_COOO_%EC%88%AB%EC%9E%90%EB%A7%8C%EC%B6%94%EC%B6%9C%EB%B3%B5%EC%82%AC.lsp)

**설치 방법**
1. 링크에서 우클릭하여 "다른 이름으로 저장"
2. 파일을 .lsp 확장자로 저장
3. AutoCAD에서 APPLOAD 명령 실행
4. 저장한 파일 선택 후 로드

## 사용 방법

### 기본 사용법

```
명령: COOO
통계를 작성할 객체들을 선택하세요: [텍스트 선택]
5개의 객체가 선택되었습니다.
5개의 숫자 객체를 생성합니다.
복사 기준점을 지정하세요: [클릭]
복사될 위치를 지정하세요: [클릭]
작업 완료! 숫자 부분만 복사되었습니다.
```

### 추출 규칙

**처리 가능한 형식**
- 정수: "수량 100개" → "100"
- 소수: "면적 123.45㎡" → "123.45"
- 쉼표: "금액 1,234,567원" → "1,234,567"
- 부호: "온도 -15.5°C" → "-15.5"

## 활용 예시

### 예시 1: 면적표 숫자 추출

```
입력:
A구역: 123.45㎡
B구역: 87.90㎡
C구역: 156.78㎡

출력:
123.45
87.90
156.78
```

면적 데이터를 엑셀로 쉽게 이관할 수 있습니다.

### 예시 2: 수량표 데이터 추출

```
입력:
철근 D10: 250개
철근 D13: 180개
철근 D16: 95개

출력:
250
180
95
```

수량 집계나 계산 작업에 활용할 수 있습니다.

### 예시 3: 금액 정보 추출

```
입력:
합계 $1,234.56
부가세 $123.46
총액 $1,358.02

출력:
1,234.56
123.46
1,358.02
```

쉼표가 유지되어 엑셀에서 즉시 인식됩니다.

### 예시 4: 엑셀 연동

```
1. COOO로 숫자 추출
2. 생성된 숫자 객체 전체 선택
3. Ctrl+C로 복사
4. 엑셀에 붙여넣기
5. SUM 함수로 합계 계산
```

AutoCAD와 엑셀 간 데이터 연동이 간편해집니다.

## 주의사항

**숫자가 없는 텍스트**
- 숫자가 포함되지 않은 텍스트는 자동으로 제외됩니다.

**복수의 숫자**
- 하나의 텍스트에 여러 숫자가 있는 경우 첫 번째 숫자만 추출됩니다.
- 예: "123-456-789" → "123"

**복사된 객체**
- 추출된 숫자 객체는 복사 후 자동으로 삭제됩니다.
- 원본 텍스트는 변경되지 않습니다.

**AutoCAD 버전**
- AutoCAD 2000 이상에서 사용 가능합니다.

## 관련 리습

- [BRN - 블록명 변경](../2025-01-15-autocad-block-rename-lisp)
- [TTC - 텍스트 교환](../2025-01-16-autocad-text-swap-lisp)
- [LOOO - 레이어 단독 표시](../2025-01-17-autocad-layer-isolate-lisp)
- [TTR - 텍스트 연속 교체](../2025-01-19-autocad-text-repeat-copy-lisp)
- [JJJ - 폴리라인 합치기](../2025-01-20-autocad-polyline-join-z-coordinate)
- [BLDEL - 해치 삭제](../2025-01-21-autocad-delete-all-hatches)
- [BCENT - 블록 중심 기준점](../2025-01-22-autocad-block-center-basepoint)
- [GGGG - 어린이보호구역 통계](../2025-01-23-autocad-auto-quantity-statistics)
